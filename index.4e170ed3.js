function e(e,t,n,i){let s=document.createElement("div");return e&&(s.id=e),t&&s.classList.add(t),i&&n&&(s.style.height=i,s.style.width=n),s}const t=new class{constructor(){this.vocabulary=[],this.wordIndex=0,this.enterMode=!1;let e=window.indexedDB.open("Vocabulary",1);e.addEventListener("error",t=>{console.error("There is an error. Have fun fixing it. Details:"+e.error)}),e.addEventListener("success",t=>{this.database=e.result;let n=this.database.transaction("vocabulary","readonly");n.onerror=e=>console.error(n.error);let i=n.objectStore("vocabulary").getAll();i.onerror=e=>console.error(i.error),i.onsuccess=e=>{this.vocabulary=i.result,this.wordIndex=this.vocabulary.length}}),e.addEventListener("upgradeneeded",t=>{let n=e.result,i=n.createObjectStore("vocabulary",{autoIncrement:!0});i.createIndex("latinWord","latinWord",{unique:!1}),i.createIndex("inflections","inflections",{unique:!1}),i.createIndex("germanTranslation","germanTranslation",{unique:!1}),i.createIndex("relatedForeignWords","relatedForeignWords",{unique:!1}),i.createIndex("selected","selected",{unique:!1}),i.createIndex("probability","probability",{unique:!1});let s=n.createObjectStore("inflected vocabulary",{autoIncrement:!0});s.createIndex("singular","singular",{unique:!1}),s.createIndex("plural","plural",{unique:!1}),s.createIndex("verb","verb",{unique:!1}),s.createIndex("probability","probability",{unique:!1}),this.database=e.result});let t=window.indexedDB.open("player data",1);t.addEventListener("upgradeneeded",e=>{let n=t.result;n.objectStoreNames.contains("versions played")||n.createObjectStore("versions played",{autoIncrement:!0}),t.addEventListener("success",e=>{let n=t.result.transaction("versions played","readwrite");n.objectStore("versions played").add("Beta"),n.oncomplete=()=>{console.log("Data added successfully")},n.onerror=e=>{console.error("Transaction error:",t.error)}}),t.addEventListener("error",e=>{console.error("Database error:",t.error)})})}modifyDocument(){let t=window.indexedDB.open("Vocabulary",1);t.addEventListener("error",e=>{console.error("There is an error. Have fun fixing it. Details:"+t.error)}),t.addEventListener("success",n=>{this.database=t.result;let i=this.database.transaction("vocabulary","readonly");i.onerror=e=>console.error(i.error);let s=i.objectStore("vocabulary").getAll();s.onerror=e=>console.error(s.error),s.onsuccess=t=>{this.vocabulary=s.result,this.wordIndex=this.vocabulary.length,this.container=document.querySelector("#container"),this.iconPlaceholder=document.querySelector("#icon-placeholder"),this.navbar=document.querySelector("#navbar"),this.container.style.padding="0",document.body.style.backgroundImage="none",document.body.setAttribute("class",""),this.container.setAttribute("class",""),this.iconPlaceholder.setAttribute("class",""),this.navbar.setAttribute("class",""),this.container.innerHTML="",this.iconPlaceholder.innerHTML="",this.navbar.innerHTML="",document.querySelector("body").classList.add("addVocabularyBody"),this.iconPlaceholder.classList.add("addVocabularyIconPlaceholder");let n=document.createElement("object");n.data="./add_vocabulary.svg",n.id="addVocabularyIcon",this.iconPlaceholder.insertAdjacentElement("beforeend",n),this.container.classList.add("addVocabularyContainer");let i="inp bg inp bg inp bg inp".split(" ");for(let t=0;t<i.length;t++){let n=e(`div${t}`,`${i[t]}`,"100%",`${100/i.length}%`);this.container.appendChild(n),n.style.padding=`${.05*n.offsetHeight}px`}this.navbar.classList.add("addVocabularyNavbar"),this.buttonLeft=document.createElement("button"),this.buttonLeft.classList.add("navButton"),this.buttonLeft.innerHTML="<",this.navbar.appendChild(this.buttonLeft),this.homeButton=document.createElement("button"),this.homeButton.classList.add("navButton");let l=document.createElement("object");l.classList.add("homeIcon"),l.data="./home.svg",l.style.height="9vh",l.addEventListener("load",e=>{l.contentDocument.addEventListener("click",e=>{o(),r.modifyDocument()})}),this.homeButton.insertAdjacentElement("beforeend",l),this.navbar.appendChild(this.homeButton),this.buttonRight=document.createElement("button"),this.buttonRight.classList.add("navButton"),this.buttonRight.innerHTML=">",this.navbar.appendChild(this.buttonRight),this.type()}})}type(){let t,n=[0,2,4,6],i=0,s=0,l={latinWord:"",inflections:"",germanTranslation:"",relatedForeignWords:"",selected:!0,probability:1};for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].addEventListener("click",n=>{for(let n=0;n<this.container.childElementCount;n+=2)this.container.children[n]===this.container.children[e]?(i=n/2,(t=this.container.children[n]).classList.add("selected"),s=t.childElementCount):this.container.children[n].classList.remove("selected")});this.container.children[n[i]].classList.add("selected");let a=(t=this.container.children[n[i]]).appendChild(e("temporary")),c=t.offsetHeight-(t.clientHeight-a.clientHeight)-parseFloat(t.style.padding);this.maxCharacters=Math.floor(window.innerWidth/c),a.remove(),this.homeButton.addEventListener("click",e=>{o(),r.modifyDocument()}),this.buttonLeft.addEventListener("mousedown",e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.add("shadow"),this.buttonLeft.classList.add("clicked")}),this.buttonRight.addEventListener("mousedown",e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.add("shadow"),this.buttonRight.classList.add("clicked")}),this.buttonLeft.addEventListener("mouseout",e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow"),this.buttonLeft.classList.remove("clicked")}),this.buttonRight.addEventListener("mouseout",e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow"),this.buttonRight.classList.remove("clicked")}),this.buttonLeft.addEventListener("mouseup",e=>{if(this.vocabulary[this.wordIndex-1]){if(4===Object.values(l).filter(e=>""===e).length&&this.wordIndex===this.vocabulary.length){for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow");this.wordIndex--,l=this.vocabulary[this.wordIndex];for(let e=0;e<this.container.childElementCount;e+=2){let t=Object.values(l)[e/2];this.container.children[e].innerHTML="";for(let n=0;n<t.length;n++){let i=document.createElement("object");i.data="./keys/OG_T.svg",i.id=`key${n}-inp${e/2}`,i.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",i),i.addEventListener("load",e=>{i.contentDocument.querySelector("#tspan7").innerHTML=t.charAt(n)})}}}else{this.vocabulary[this.wordIndex]=l;let e=this.database.transaction("vocabulary","readwrite");e.onerror=t=>console.error(e.error);let t=e.objectStore("vocabulary"),n=t.get(this.wordIndex);n.onerror=e=>console.error(n.error),n.onsuccess=e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow");let n=t.put(l,this.wordIndex+1);n.onerror=e=>console.error(n.error),this.wordIndex--,l=this.vocabulary[this.wordIndex];for(let e=0;e<this.container.childElementCount;e+=2){let t=Object.values(l)[e/2];this.container.children[e].innerHTML="";for(let n=0;n<t.length;n++){let i=document.createElement("object");i.data="./keys/OG_T.svg",i.id=`key${n}-inp${e/2}`,i.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",i),i.addEventListener("load",e=>{i.contentDocument.querySelector("#tspan7").innerHTML=t.charAt(n)})}}}}}}),this.buttonRight.addEventListener("mouseup",e=>{if(this.buttonRight.classList.remove("clicked"),this.vocabulary[this.wordIndex+1]){this.vocabulary[this.wordIndex]=l;for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow");let e=this.database.transaction("vocabulary","readwrite");e.onerror=t=>console.error(e.error);let t=e.objectStore("vocabulary"),n=t.get(this.wordIndex);n.onerror=e=>console.error(n.error),n.onsuccess=e=>{let n=t.put(l,this.wordIndex+1);n.onerror=e=>console.log(n.error),this.wordIndex++,l=this.vocabulary[this.wordIndex];for(let e=0;e<this.container.childElementCount;e+=2){let t=Object.values(l)[e/2];this.container.children[e].innerHTML="";for(let n=0;n<t.length;n++){let i=document.createElement("object");i.data="./keys/OG_T.svg",i.id=`key${n}-inp${e/2}`,i.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",i),i.addEventListener("load",e=>{i.contentDocument.querySelector("#tspan7").innerHTML=t.charAt(n)})}}}}else{this.vocabulary[this.wordIndex]=l;let e=this.database.transaction("vocabulary","readwrite");e.onerror=t=>console.error(e.error);let n=e.objectStore("vocabulary").put(l,this.wordIndex+1);n.onerror=e=>console.error(n.error),e.oncomplete=e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow");this.wordIndex++,s=0,l={latinWord:"",inflections:"",germanTranslation:"",relatedForeignWords:"",selected:!0,probability:1};for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].innerHTML="",i=0,(t=this.container.children[0]).classList.add("selected"),0!=e&&this.container.children[e].classList.remove("selected")}}}),this.keyDownFunction=e=>{if("Backspace"===e.key){t.lastElementChild&&(t.lastElementChild.remove(),Object.defineProperty(l,Object.keys(l)[i],{value:Object.values(l)[i].slice(0,s-1)}),s--);return}if("Enter"===e.key||"ArrowDown"===e.key){if(i+1<4){i++,t=this.container.children[n[i]];for(let e=0;e<this.container.childElementCount;e++)this.container.children[e]!=t?this.container.children[e].classList.remove("selected"):(t.classList.add("selected"),s=t.childElementCount)}else{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.add("shadow");if(this.enterMode){if(this.buttonRight.classList.remove("clicked"),this.vocabulary[this.wordIndex+1]){this.vocabulary[this.wordIndex]=l;for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow");let e=this.database.transaction("vocabulary","readwrite");e.onerror=t=>console.error(e.error);let t=e.objectStore("vocabulary"),n=t.get(this.wordIndex);n.onerror=e=>console.error(n.error),n.onsuccess=e=>{let n=t.put(l,this.wordIndex+1);n.onerror=e=>console.log(n.error),this.wordIndex++,l=this.vocabulary[this.wordIndex];for(let e=0;e<this.container.childElementCount;e+=2){let t=Object.values(l)[e/2];this.container.children[e].innerHTML="";for(let n=0;n<t.length;n++){let i=document.createElement("object");i.data="./keys/OG_T.svg",i.id=`key${n}-inp${e/2}`,i.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",i),i.addEventListener("load",e=>{i.contentDocument.querySelector("#tspan7").innerHTML=t.charAt(n)})}}}}else{this.vocabulary[this.wordIndex]=l;let e=this.database.transaction("vocabulary","readwrite");e.onerror=t=>console.error(e.error);let n=e.objectStore("vocabulary").put(l,this.wordIndex+1);n.onerror=e=>console.error(n.error),e.oncomplete=e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow");this.wordIndex++,s=0,l={latinWord:"",inflections:"",germanTranslation:"",relatedForeignWords:"",selected:!0,probability:1};for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].innerHTML="",i=0,(t=this.container.children[0]).classList.add("selected"),0!=e&&this.container.children[e].classList.remove("selected")}}this.enterMode=!1}else this.enterMode=!0;let e=this.database.transaction("vocabulary","readwrite");e.onerror=t=>console.error(e.error);let n=e.objectStore("vocabulary").put(l,this.wordIndex+1);n.onerror=e=>console.error(n.error),setTimeout(e=>{for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].classList.remove("shadow")},250)}return}if("ArrowUp"===e.key){i>0&&i--,t=this.container.children[n[i]];for(let e=0;e<this.container.childElementCount;e++)this.container.children[e]!=t?this.container.children[e].classList.remove("selected"):(t.classList.add("selected"),s=t.childElementCount);return}if(["<","´","`","^"].includes(e.key)||e.key.length>1)return;let r=document.createElement("object");r.data="./keys/OG_T.svg",r.id=`key${s}-inp${i}`,r.style.height="100%",t.insertAdjacentElement("beforeend",r);let o=r.clientHeight;r.hidden=!0,r.addEventListener("load",n=>{if(s>=Math.floor(window.innerWidth/o)){r.remove();for(let e=0;e<s;e++)this.failureAnimation(t.children[e]);return}r.hidden=!1,r.contentDocument.querySelector("#tspan7").innerHTML=e.key.charAt(0),Object.defineProperty(l,Object.keys(l)[i],{value:Object.values(l)[i]+e.key.charAt(0)}),s++,this.idleAnimation(r)})},document.addEventListener("keydown",this.keyDownFunction)}failureAnimation(e){if(!e)return;let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s=[{stroke:"rgb(186, 2, 70)",offset:.025},{rotate:"10deg z",offset:.25},{rotate:"0deg z",offset:.5},{rotate:"-10deg z",offset:.75,stroke:"rgb(186, 2, 70)"},{stroke:"#eeeeeeff",offset:.925},{rotate:"0deg z",offset:1}],r={duration:500};n.animate(s,r),i.animate(s,r)}idleAnimation(e){let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#8f8f8f","#fff","#eeeeeeff"],offset:[0,1]},r={duration:250};n.animate(s,r),i.animate(s,r)}},n=new class{constructor(){}modifyDocument(){let n=window.indexedDB.open("Vocabulary",1);n.addEventListener("error",e=>{this.vocabulary=[],this.modifyDocument(),console.error(n.error)}),n.addEventListener("success",i=>{this.database=n.result;let s=this.database.transaction("vocabulary","readonly");s.onerror=e=>console.error(s.error);let l=s.objectStore("vocabulary").getAll();l.onerror=e=>console.error(l.error),l.onsuccess=n=>{this.vocabulary=l.result,this.container=document.querySelector("#container"),this.iconPlaceholder=document.querySelector("#icon-placeholder"),this.navbar=document.querySelector("#navbar"),this.container.style.padding="0",document.body.style.backgroundImage="none",document.body.setAttribute("class",""),this.container.setAttribute("class",""),this.iconPlaceholder.setAttribute("class",""),this.navbar.setAttribute("class",""),this.container.innerHTML="",this.iconPlaceholder.innerHTML="",this.navbar.innerHTML="";let i=document.createElement("object");i.data="./show_vocabulary.svg",i.id="showVocabularyIcon",this.iconPlaceholder.insertAdjacentElement("beforeend",i);for(let e=0,t="HOME MENU";e<t.length;e++){let n=document.createElement("span");n.innerText=t[e],this.navbar.insertAdjacentElement("beforeend",n)}let s=e=>{o(),this.navbar.removeEventListener("click",s),r.modifyDocument()};this.navbar.addEventListener("click",s),document.body.classList.add("showVocabularyBody"),this.container.classList.add("showVocabularyContainer"),this.iconPlaceholder.classList.add("showVocabularyIconPlaceholder"),this.navbar.classList.add("showVocabularyNavbar");let a="";this.vocabulary.forEach((n,i)=>{a+="auto ";let s=e(`checkboxDiv${i}`,"word"),r=e(`latinWord${i}`,"word"),o=e(`inflections${i}`,"word"),l=e(`germanTranslation${i}`,"word"),c=e(`relatedForeignWords${i}`,"word");s.classList.add("cdiv"),s.innerHTML=`<input type="checkbox" id="C${i}" class="checkbox" ${n.selected?"checked":""}></input>`,r.innerHTML=`<input type="text" id="0-${i}" class="edit" value="${""===n.latinWord?" ":n.latinWord}" maxlength="${n.latinWord.length>t.maxCharacters?n.latinWord.length:t.maxCharacters}"></input>`,o.innerHTML=`<input type="text" id="1-${i}" class="edit" value="${""===n.inflections?" ":n.inflections}" maxlength="${n.inflections.length>t.maxCharacters?n.inflections.length:t.maxCharacters}"></input>`,l.innerHTML=`<input type="text" id="2-${i}" class="edit" value="${""===n.germanTranslation?" ":n.germanTranslation}" maxlength="${n.germanTranslation.length>t.maxCharacters?n.germanTranslation.length:t.maxCharacters}"></input>`,c.innerHTML=`<input type="text" id="3-${i}" class="edit" value="${""===n.relatedForeignWords?" ":n.relatedForeignWords}" maxlength="${n.relatedForeignWords.length>t.maxCharacters?n.relatedForeignWords.length:t.maxCharacters}"></input>`,this.container.append(s,r,o,l,c)}),this.container.style.gridTemplateRows=a;let c=document.getElementsByClassName("edit");for(let e=0;e<c.length;e++){let t=c.item(e);t.size=t.maxLength,t.onblur=e=>{let n=this.database.transaction("vocabulary","readwrite");n.onerror=e=>console.error(n.error);let i=n.objectStore("vocabulary"),s=i.get(parseInt(t.id.split("-")[1])+1);s.onerror=e=>console.error(s.error),s.onsuccess=e=>{let n=s.result;Object.defineProperty(n,Object.keys(n)[parseInt(t.id.split("-")[0])],{value:t.value.trim()});let r=i.put(n,parseInt(t.id.split("-")[1])+1);r.onerror=e=>console.error(r.error)}},t.onkeydown=e=>{"Enter"===e.key&&t.blur()},t.onkeyup=e=>{if(t.value.includes("^")){let e="";t.value.split("").forEach(t=>{"^"!=t&&(e+=t)}),t.value=e}}}let d=document.getElementsByClassName("checkbox");for(let e=0;e<d.length;e++){let t=d.item(e);t.addEventListener("change",n=>{let i=this.database.transaction("vocabulary","readwrite");i.onerror=e=>console.error(i.error);let s=i.objectStore("vocabulary"),r=s.get(parseInt(t.id.slice(1))+1);r.onerror=e=>console.error(r.error),r.onsuccess=n=>{let i=r.result;Object.defineProperty(i,"selected",{value:t.checked});let o=s.put(i,parseInt(t.id.slice(1))+1);o.onerror=e=>console.error(o.error),this.vocabulary[e].selected=!this.vocabulary[e].selected}})}let h=document.getElementsByClassName("cdiv");for(let e=0;e<h.length;e++){let t,n,i=h[e],s=!1,r=e=>{let t=parseInt(e.target.id.slice(11));this.deleteWord(t)};i.addEventListener("mousemove",o=>{o.target===i.querySelector("input")?(s=!1,i.classList.remove("mouseon"),clearTimeout(n),i.removeEventListener("click",r),document.querySelectorAll(".danger").forEach(e=>e.classList.remove("danger"))):s||(s=!0,t=i.innerHTML,i.classList.add("mouseon"),n=setTimeout(t=>{s&&(i.innerHTML="<span>X</span>",i.addEventListener("click",r),document.querySelector(`#latinWord${e}`).classList.add("danger"),document.querySelector(`#inflections${e}`).classList.add("danger"),document.querySelector(`#germanTranslation${e}`).classList.add("danger"),document.querySelector(`#relatedForeignWords${e}`).classList.add("danger"))},1500))}),i.addEventListener("mouseleave",o=>{if(s=!1,i.classList.remove("mouseon"),clearTimeout(n),document.querySelectorAll(".danger").forEach(e=>e.classList.remove("danger")),t&&!i.querySelector("input")){i.innerHTML=t;let n=i.querySelector("input");n.checked=this.vocabulary[e].selected,n.addEventListener("change",t=>{let i=this.database.transaction("vocabulary","readwrite");i.onerror=e=>console.error(i.error);let s=i.objectStore("vocabulary"),r=s.get(parseInt(n.id[n.id.length-1])+1);r.onerror=e=>console.error(r.error),r.onsuccess=t=>{let i=r.result;Object.defineProperty(i,"selected",{value:n.checked});let o=s.put(i,parseInt(n.id[n.id.length-1])+1);o.onerror=e=>console.error(o.error),this.vocabulary[e].selected=n.checked}})}i.removeEventListener("click",r)})}}})}deleteWord(e){this.vocabulary.splice(e,1);let t=this.database.transaction("vocabulary","readwrite").objectStore("vocabulary").openCursor();t.onsuccess=e=>{let n=t.result;if(n){let e=n.key,t=this.vocabulary[e-1];if(t){let e=n.value;e.latinWord=t.latinWord,e.inflections=t.inflections,e.germanTranslation=t.germanTranslation,e.relatedForeignWords=t.relatedForeignWords,e.selected=t.selected,e.probability=t.probability,n.update(e),n.continue()}else n.delete(),o(),this.modifyDocument()}}}},i=new class{constructor(){this.totalAttempts=0,this.totalPoints=0,this.commandMode=!1,this.command="",this.inputIndex=0,this.time=0,this.round=0,this.backgroundColor="#140063",setInterval(e=>this.time+=1,1),this.resizeFunction=e=>{document.querySelectorAll(".inp").forEach(e=>{e.firstChild&&!e.classList.contains("not-editable")&&this.movementAnimation()})}}modifyDocument(){window.addEventListener("resize",this.resizeFunction);let t=window.indexedDB.open("Vocabulary",1);t.addEventListener("error",e=>{this.vocabulary=[],this.modifyDocument(),console.error(t.error)}),t.addEventListener("success",n=>{this.database=t.result;let i=this.database.transaction("vocabulary","readonly");i.onerror=e=>console.error(i.error);let s=i.objectStore("vocabulary").getAll();s.onerror=e=>console.error(s.error),s.onsuccess=t=>{this.vocabulary=s.result,this.backgroundColor="#140063",this.container=document.querySelector("#container"),this.iconPlaceholder=document.querySelector("#icon-placeholder"),this.navbar=document.querySelector("#navbar"),this.container.style.padding="0",document.body.style.backgroundImage="none",document.body.setAttribute("class",""),this.container.setAttribute("class",""),this.iconPlaceholder.setAttribute("class",""),this.navbar.setAttribute("class",""),this.container.innerHTML="",this.iconPlaceholder.innerHTML="",this.navbar.innerHTML="";let n=document.createElement("object");n.data="./training.svg",n.id="trainingIcon",this.iconPlaceholder.insertAdjacentElement("beforeend",n),document.body.classList.add("trainingBody"),this.container.classList.add("trainingContainer"),this.iconPlaceholder.classList.add("trainingIconPlaceholder"),this.navbar.classList.add("trainingNavbar");let i="inp bg inp bg inp bg inp".split(" ");for(let t=0;t<i.length;t++){let n=e(`div${t}`,`${i[t]}`,"100%",`${100/i.length}%`);n.classList.add("t"),this.container.appendChild(n),n.style.padding=`${.05*n.offsetHeight}px`}this.mouseOverFunction=e=>{let t=document.querySelector(".homeDiv");if(t&&t!=e.target&&e.target!=this.navbar&&!(document.querySelector(".homeButton")&&e.target===document.querySelector(".homeButton"))&&e.target!=document.querySelector(".homeIcon")?(t.classList.remove("moveUp"),setTimeout(e=>t.classList.add("moveDown"),0)):e.target!=this.navbar&&!(document.querySelector(".homeButton")&&e.target===document.querySelector(".homeButton"))&&e.target!=document.querySelector(".homeIcon")||t.classList.contains("moveUp")||(t.classList.remove("moveDown"),t.classList.add("moveUp")),!t){let e=document.createElement("div");e.setAttribute("class","homeDiv"),this.navbar.insertAdjacentElement("afterend",e);let t=document.createElement("div");t.classList.add("homeButton");let n=document.createElement("object");n.classList.add("homeIcon"),n.data="./home.svg",n.style.height="6vh",e.insertAdjacentElement("beforeend",t),t.insertAdjacentElement("beforeend",n);let i=e=>{o(),r.modifyDocument()};t.addEventListener("click",i),n.addEventListener("load",e=>{n.contentDocument.addEventListener("click",i)})}},document.addEventListener("mouseover",this.mouseOverFunction),this.type()}})}type(){let e=[0,2,4,6],n=0;for(let e=0;e<this.container.childElementCount;e+=2)this.container.children[e].addEventListener("click",t=>{this.inputIndex=e/2,this.selectedInput=this.container.children[e],this.inputStyling(),n=this.selectedInput.childElementCount});for(let e=1;e<this.container.childElementCount;e+=2)this.container.children[e].addEventListener("click",t=>{t.offsetY>this.container.children[e].clientHeight/2?(this.inputIndex=(e+1)/2,this.selectedInput=this.container.children[e+1]):(this.inputIndex=(e-1)/2,this.selectedInput=this.container.children[e-1]),this.inputStyling(),n=this.selectedInput.childElementCount});this.selectedInput=this.container.children[e[this.inputIndex]],this.inputStyling(),this.keyDownFunction=i=>{let s=this.commandMode,r=["<","´","`","^"];if(this.commandMode){if("Enter"===i.key){switch(this.command){case"#hint":case"#t":case"#tip":case"#tipp":case"#Tipp":let i;this.command.split("").forEach(e=>{this.returnLastElement(this.selectedInput).remove(),n--,this.selectedInput.firstChild&&this.movementAnimation()});let r=document.createElement("object");r.data="./keys/OG_T.svg",r.id=`key${n}-inp${this.inputIndex}`,r.style.height="100%";let o=r.clientHeight,l=0,a=Object.values(this.currentWord)[this.inputIndex],c="",d=!1;for(let e=0;e<a.length;e++)a[e]==Object.values(this.vocabulary[this.currentWordIndex])[this.inputIndex][e]||d?c+=a[e]:(l=e,this.vocabulary[this.currentWordIndex][Object.keys(this.vocabulary[this.currentWordIndex])[this.inputIndex]][l]?c+=this.vocabulary[this.currentWordIndex][Object.keys(this.vocabulary[this.currentWordIndex])[this.inputIndex]][l]:i=a.length-1,d=!0);if(this.currentWord[Object.keys(this.currentWord)[this.inputIndex]]=i?c.slice(0,i):c,a=i?c.slice(0,i):c,i){this.returnLastElement(this.selectedInput).remove(),this.movementAnimation(),n--,s=!1,this.commandMode=!1;break}if(!d){if(l=a.length,a.length<Object.values(this.vocabulary[this.currentWordIndex])[this.inputIndex].length)this.currentWord[Object.keys(this.currentWord)[this.inputIndex]]+=Object.values(this.vocabulary[this.currentWordIndex])[this.inputIndex][l];else{s=!1,this.commandMode=!1;break}}a.length>0&&l<a.length?(this.selectedInput.children[l].replaceWith(r),n--):this.selectedInput.insertAdjacentElement("beforeend",r),r.hidden=!0,r.addEventListener("load",e=>{if(n>=Math.floor(window.innerWidth/o)){r.remove();for(let e=0;e<n;e++)t.failureAnimation(this.selectedInput.children[e]);return}r.hidden=!1,n++,r.contentDocument.querySelector("#tspan7").innerHTML=Object.values(this.vocabulary[this.currentWordIndex])[this.inputIndex][l],this.fixedAnimation(r),this.movementAnimation()});break;case"#pensionistenmodus":case"#Pensionistenmodus":this.backgroundColor="#7a4aff",this.inputStyling(),this.command.split("").forEach(e=>{this.returnLastElement(this.selectedInput).remove(),n--,this.selectedInput.firstChild&&this.movementAnimation()});break;default:this.command.split("").forEach(e=>{this.returnLastElement(this.selectedInput).remove(),n--,this.selectedInput.firstChild&&this.movementAnimation()}),this.inputIndex+1<4&&(this.inputIndex++,this.selectedInput=this.container.children[e[this.inputIndex]],this.inputIndex+1<4&&this.selectedInput.classList.contains("not-editable")&&(this.inputIndex+=1,this.selectedInput=this.container.children[this.inputIndex]),n=this.selectedInput.childElementCount,this.inputStyling())}this.command="",this.commandMode=!1}else"ArrowUp"===i.key?(this.command.split("").forEach(e=>{this.returnLastElement(this.selectedInput).remove(),n--,this.selectedInput.firstChild&&this.movementAnimation()}),this.command="",this.commandMode=!1):"ArrowDown"===i.key?(this.command.split("").forEach(e=>{this.returnLastElement(this.selectedInput).remove(),n--,this.selectedInput.firstChild&&this.movementAnimation()}),this.command="",this.commandMode=!1,this.inputIndex+1<4&&(this.inputIndex++,this.selectedInput=this.container.children[e[this.inputIndex]],this.inputIndex+1<4&&this.selectedInput.classList.contains("not-editable")&&(this.inputIndex+=1,this.selectedInput=this.container.children[this.inputIndex]),n=this.selectedInput.childElementCount,this.inputStyling())):"Backspace"===i.key&&this.returnLastElement(this.selectedInput)&&(this.returnLastElement(this.selectedInput).remove(),this.command=this.command.slice(0,this.command.length-1),n--,this.selectedInput.firstChild&&this.movementAnimation(),""===this.command&&(this.commandMode=!1));if(this.commandMode&&(this.selectedInput.classList.contains("not-editable")||r.includes(i.key)||i.key.length>1))return}if(!this.commandMode){if("Enter"!==i.key&&"ArrowDown"!==i.key||s){if("ArrowUp"===i.key){this.inputIndex>0&&this.inputIndex--,this.selectedInput=this.container.children[e[this.inputIndex]],n=this.selectedInput.childElementCount,this.inputStyling();return}if(this.selectedInput.classList.contains("not-editable"))return;if("Backspace"!==i.key||s){if(r.includes(i.key)||i.key.length>1)return;"#"===i.key&&(this.commandMode=!0)}else{this.returnLastElement(this.selectedInput)&&(this.returnLastElement(this.selectedInput).remove(),n--,this.selectedInput.firstChild&&this.movementAnimation(),!this.currentWord||isNaN(this.currentWordIndex)||this.commandMode||Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex],{value:Object.values(this.currentWord)[this.inputIndex].slice(0,n)}));return}}else{if(this.currentWord&&!isNaN(this.currentWordIndex)&&"Enter"===i.key){if(Object.values(this.currentWord)[this.inputIndex]===Object.values(this.vocabulary[this.currentWordIndex])[this.inputIndex]||""===Object.values(this.currentWord)[this.inputIndex]){for(let e=0;e<n;e++)this.selectedInput.children[e]&&!this.selectedInput.classList.contains("not-editable")&&this.successAnimation(this.selectedInput.children[e]);if(this.selectedInput.classList.contains("not-editable")||void 0!==this.result[this.inputIndex]||(this.result[this.inputIndex]=!0),this.inputIndex+1<4)this.inputIndex++,this.selectedInput=this.container.children[e[this.inputIndex]],this.inputIndex+1<4&&this.selectedInput.classList.contains("not-editable")&&(this.inputIndex+=1,this.selectedInput=this.container.children[e[this.inputIndex]]),n=this.selectedInput.childElementCount,this.inputStyling();else if(this.inputIndex+1===4){let i=[void 0,void 0,void 0,void 0];if(Object.values(this.currentWord).slice(0,4).forEach((n,s)=>{if(!document.querySelector(`#div${e[s]}`).classList.contains("not-editable")){if(n===Object.values(this.vocabulary[this.currentWordIndex])[s]){let t=document.querySelector(`#div${e[s]}`);for(let e=0;e<t.childElementCount;e++){let n=t.children[e];this.successAnimation(n)}""===n&&(i[s]=!0),void 0===this.result[s]&&(this.result[s]=!0)}else{let r=document.querySelector(`#div${e[s]}`);for(let e=0;e<r.childElementCount;e++){let n=r.children[e];t.failureAnimation(n)}""===n&&(i[s]=!1),void 0===this.result[s]&&(this.result[s]=!1)}}}),this.resultStyling(i),Object.values(this.currentWord).toLocaleString()===Object.values(this.vocabulary[this.currentWordIndex]).toLocaleString()){let t=this.result.filter(e=>!0===e).length;this.totalAttempts+=3,this.totalPoints+=t,3===t?this.vocabulary[this.currentWordIndex].probability*=.8:this.vocabulary[this.currentWordIndex].probability*=1.2;let i=this.database.transaction("vocabulary","readwrite");i.onerror=e=>console.error(i.error);let s=i.objectStore("vocabulary"),r=s.get(this.currentWordIndex+1);r.onerror=e=>console.error(r.error),r.onsuccess=e=>{let t=s.put(this.vocabulary[this.currentWordIndex],this.currentWordIndex+1);t.onerror=e=>console.error(t.error)},setTimeout(t=>{this.inputIndex=0,this.selectedInput=document.querySelector(`#div${e[this.inputIndex]}`),n=0,this.inputStyling(),this.startNewTrainingRound()},500)}else setTimeout(e=>this.inputStyling(),500)}}else if(this.selectedInput.classList.contains("not-editable"))this.inputIndex+1<4&&(this.inputIndex++,this.selectedInput=this.container.children[e[this.inputIndex]],this.inputIndex+1<4&&this.selectedInput.classList.contains("not-editable")&&(this.inputIndex+=1,this.selectedInput=this.container.children[e[this.inputIndex]]),n=this.selectedInput.childElementCount,this.inputStyling());else{if(3===this.inputIndex){let n=[void 0,void 0,void 0,void 0];Object.values(this.currentWord).slice(0,4).forEach((i,s)=>{if(!document.querySelector(`#div${e[s]}`).classList.contains("not-editable")){if(i===Object.values(this.vocabulary[this.currentWordIndex])[s]){let t=document.querySelector(`#div${e[s]}`);for(let e=0;e<t.childElementCount;e++){let n=t.children[e];this.successAnimation(n)}""===i&&(n[s]=!0),void 0===this.result[s]&&(this.result[s]=!0)}else{let r=document.querySelector(`#div${e[s]}`);for(let e=0;e<r.childElementCount;e++){let n=r.children[e];t.failureAnimation(n)}""===i&&(n[s]=!1),void 0===this.result[s]&&(this.result[s]=!1)}}}),this.resultStyling(n),setTimeout(e=>this.inputStyling(),500)}else for(let e=0;e<this.selectedInput.childElementCount;e++)t.failureAnimation(this.selectedInput.children[e]);void 0===this.result[this.inputIndex]&&(this.result[this.inputIndex]=!0),this.result[this.inputIndex]=!1}}else"ArrowDown"===i.key&&this.inputIndex+1<4&&(this.inputIndex++,this.selectedInput=this.container.children[e[this.inputIndex]],this.inputIndex+1<4&&this.selectedInput.classList.contains("not-editable")&&(this.inputIndex+=1,this.selectedInput=this.container.children[e[this.inputIndex]]),n=this.selectedInput.childElementCount,this.inputStyling());return}}let o=document.createElement("object");o.data="./keys/OG_T.svg",o.id=`key${n}-inp${this.inputIndex}`,o.style.height="100%",this.selectedInput.insertAdjacentElement("beforeend",o);let l=o.clientHeight;o.hidden=!0,o.addEventListener("load",e=>{if(n>=Math.floor(window.innerWidth/l)){o.remove();for(let e=0;e<n;e++)t.failureAnimation(this.selectedInput.children[e]);return}o.hidden=!1,o.contentDocument.querySelector("#tspan7").innerHTML=i.key.charAt(0),!this.currentWord||isNaN(this.currentWordIndex)||this.commandMode||Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex],{value:Object.values(this.currentWord)[this.inputIndex]+i.key.charAt(0)}),n++,t.idleAnimation(o),this.movementAnimation(),this.commandMode&&(this.commandAnimation(o),this.command+=i.key)})},document.addEventListener("keydown",this.keyDownFunction),this.startNewTrainingRound()}startNewTrainingRound(){let e,t;if(0===this.vocabulary.length){setTimeout(e=>alert("Keine Vokabeln!"),50);return}this.round++;let n=0;this.vocabulary.forEach(e=>{e.selected&&(n+=e.probability)});let i=Math.floor(Math.random()*n*10)/10,s=0;this.vocabulary.forEach((t,n)=>{t.selected&&(void 0===e?(e=Math.abs(i-(s+t.probability)),this.currentWord=t,this.currentWordIndex=n):Math.abs(i-(s+t.probability))<e&&(e=Math.abs(i-(s+t.probability)),this.currentWordIndex=n,Object.values(t).toLocaleString().slice(0,4)===Object.values(this.currentWord).toLocaleString().slice(0,4)&&(t.probability=Math.max(0,t.probability-1)),this.currentWord=t),s+=t.probability)});do{let e=Math.random();e<=.5?(t=["latinWord",{value:this.currentWord.latinWord}],this.inputIndex=1,this.selectedInput=this.container.children[this.inputIndex+1],this.inputStyling()):t=e<=.7?["inflections",{value:this.currentWord.inflections}]:e<=.95?["germanTranslation",{value:this.currentWord.germanTranslation}]:["relatedForeignWords",{value:this.currentWord.relatedForeignWords}]}while(""===t[1].value.trim())this.currentWord={latinWord:"",inflections:"",germanTranslation:"",relatedForeignWords:"",selected:!0,probability:this.currentWord.probability},Object.defineProperty(this.currentWord,t[0],t[1]);let r=document.querySelector(".not-editable");r&&r.classList.remove("not-editable"),document.querySelectorAll(".t").forEach(e=>e.innerHTML="");let o=document.getElementById(`div${2*Object.keys(this.currentWord).findIndex(e=>e===t[0])}`);o.classList.add("not-editable"),o.innerHTML=`<span style="font-size:${.6*o.clientHeight}px">${t[1].value}</span>`,this.result=[void 0,void 0,void 0,void 0]}movementAnimation(){let e=this.selectedInput.firstChild,t=this.selectedInput;this.selectedInput.firstChild&&(t.childElementCount>1&&(t.style.transition="padding 250ms"),t.style.paddingLeft=`${(window.innerWidth-t.childElementCount*e.clientHeight)/2}px`)}commandAnimation(e){if(!e)return;let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#eeeeeeff","#ffa500"],offset:[0,1]},r={duration:500,fill:"forwards"};n.animate(s,r),i.animate(s,r)}fixedAnimation(e){if(!e)return;e.classList.add("fixed");let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#eeeeeeff","#ffff00"],offset:[0,1]},r={duration:500,fill:"forwards"};n.animate(s,r),i.animate(s,r)}successAnimation(e){if(!e)return;let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#eeeeeeff","#08a000","#eeeeeeff"],offset:[0,1]},r={duration:500};n.animate(s,r),i.animate(s,r)}returnLastElement(e){if(e.childElementCount>0&&!e.lastElementChild.classList.contains("fixed"))return e.lastElementChild}inputStyling(){document.body.style.backgroundImage=`
            linear-gradient(180deg, 
                ${this.backgroundColor} 0%, 
                #06011b ${20+2*this.inputIndex*(window.innerHeight/document.body.scrollHeight)*(65/7)}%,
                #06011b ${20+(2*this.inputIndex+1)*(window.innerHeight/document.body.scrollHeight)*(65/7)}%, 
                ${this.backgroundColor} ${window.innerHeight/document.body.scrollHeight*100}%
            )
        `}resultStyling(e){document.body.style.transition="background-image 250ms";let t="linear-gradient(180deg,";e.forEach((e,n)=>{let i;i=!0===e?"#2be231":!1===e?"#e80000":"#140063",t+=`#140063 ${20+2*n*(window.innerHeight/document.body.scrollHeight)*(65/7)}%,
                ${i} ${20+(2*n+.5)*(window.innerHeight/document.body.scrollHeight)*(65/7)}%, 
                #140063 ${20+(2*n+1)*(window.innerHeight/document.body.scrollHeight)*(65/7)}%, `}),document.body.style.backgroundImage=t.slice(0,t.length-2)+")"}},s=new class{constructor(){this.enterMode=!1,this.tabMode=!1,this.tabulator="",this.tabCount=0,this.v=1,this.round=0,this.failures=0,this.totalAttempts=0,this.totalPoints=0,this.badColor="rgb(186, 2, 70)"}modifyDocument(t){let n;switch(this.container=document.querySelector("#container"),this.iconPlaceholder=document.querySelector("#icon-placeholder"),this.navbar=document.querySelector("#navbar"),this.container.setAttribute("style",""),document.body.style.backgroundImage="none",document.body.setAttribute("class",""),this.container.setAttribute("class",""),this.iconPlaceholder.setAttribute("class",""),this.navbar.setAttribute("class",""),this.container.innerHTML="",this.iconPlaceholder.innerHTML="",this.navbar.innerHTML="",t||(t="add nouns"),(n=document.createElement("object")).id="inflectVocabularyIcon",this.v=0,this.badColor="rgb(186, 2, 70)",t){case"add verbs":case"verbs":this.v=9,this.badColor="#ff00d4","add verbs"===t?n.data="./conjugations.svg":n.data="./conjugate_verbs.svg";default:let i=window.indexedDB.open("Vocabulary",1);i.onerror=e=>console.log(i.error),i.onsuccess=s=>{this.database=i.result,this.tabulator="";let l=this.database.transaction("inflected vocabulary","readonly");l.onerror=e=>console.error(l.error);let a=l.objectStore("inflected vocabulary").getAll();a.onerror=e=>console.error(a.error),a.onsuccess=i=>{this.vocabulary=a.result,document.body.classList.add("inflectVocabularyBody"),this.iconPlaceholder.classList.add("inflectVocabularyIconPlaceholder"),"add nouns"===t?n.data="./declinations.svg":"nouns"===t&&(n.data="./decline_nouns.svg"),this.iconPlaceholder.insertAdjacentElement("beforeend",n),"add verbs"===t||"verbs"===t?this.container.classList.add("inflectVocabularyContainer","verbs"):this.container.classList.add("inflectVocabularyContainer","nouns"),this.navbar.classList.add("inflectVocabularyNavbar"),this.container.tabIndex=0;for(let n=0;n<21-this.v;n++){let i=e(`div${n}`,"editable");this.container.insertAdjacentElement("beforeend",i),n<3&&(i.classList.add("firstrow"),i.classList.remove("editable"),i.style.fontSize=`${.75*i.offsetHeight}px`,1===n?i.innerHTML="Singular":2===n&&(i.innerHTML="Plural")),n%3==0&&(i.classList.add("firstcolumn"),i.classList.remove("editable"),i.style.fontSize=`${.25*i.offsetHeight}px`,n>0&&(i.innerHTML=`${n/3}. ${t.includes("verb")?"P":"F"}.`)),n<3||n%3==0||(i.style.padding=`${.05*i.offsetHeight}px`,t.includes("add")||i.classList.add("shadowDesign")),t.includes("verb")&&i.classList.add("v")}t.startsWith("add")&&(this.buttonLeft=document.createElement("button"),this.buttonLeft.classList.add("roundButton","c"),this.buttonLeft.innerHTML="<",this.navbar.appendChild(this.buttonLeft)),this.homeButton=document.createElement("button"),this.homeButton.classList.add("roundButton"),this.homeButton.tabIndex=-1;let s=document.createElement("object");s.classList.add("homeIcon"),s.data="./home.svg",s.style.height="7.5vh",s.addEventListener("load",e=>{s.contentDocument.addEventListener("click",e=>{o(),this.tabMode&&this.cancelTabMode(),r.modifyDocument()})}),this.homeButton.onclick=e=>{o(),this.tabMode&&this.cancelTabMode(),r.modifyDocument()},this.homeButton.insertAdjacentElement("beforeend",s),this.navbar.appendChild(this.homeButton),t.startsWith("add")&&(this.deletionButton=document.createElement("button"),this.deletionButton.classList.add("roundButton","deletionButton"),this.deletionButton.innerHTML="X",this.deletionButton.tabIndex=-1,t.includes("verb")&&this.deletionButton.classList.add("v"),this.navbar.appendChild(this.deletionButton),this.buttonRight=document.createElement("button"),this.buttonRight.classList.add("roundButton","c"),this.buttonRight.innerHTML=">",this.buttonRight.tabIndex=-1,this.navbar.appendChild(this.buttonRight)),t?this.type(t):this.type()}}}}type(e){switch(e){case"verbs":case"nouns":this.keys=0,document.querySelectorAll(".editable").forEach(e=>{e.addEventListener("click",t=>{this.selectedInput=e,this.keys=this.selectedInput.childElementCount,document.querySelectorAll(".selectedElement").forEach(e=>e.classList.remove("selectedElement")),e.classList.add("selectedElement"),this.inputIndex=parseInt(e.id.slice(3))})}),this.selectedInput=document.getElementById("div4"),this.selectedInput.classList.add("selectedElement"),this.inputIndex=4,this.wordIndex=this.vocabulary.length,this.currentWord={singular:this.empty(e),plural:this.empty(e),verb:e.includes("verb"),probability:1},this.keydownFunction=t=>{if("ArrowRight"===t.key){this.inputIndex<20-this.v&&(this.inputIndex++,this.inputIndex%3==0&&this.inputIndex++,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount);return}if("ArrowLeft"===t.key){this.inputIndex>4&&(this.inputIndex--,this.inputIndex%3==0&&this.inputIndex--,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount);return}if("ArrowDown"===t.key||"Enter"===t.key){if(this.inputIndex<20-this.v&&"Enter"===t.key&&!this.selectedInput.classList.contains("known-case")){if(this.compare(Object.values(this.currentWord)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1],Object.values(this.vocabulary[this.currentWordIndex])[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1])){for(let e=0;e<this.selectedInput.childElementCount;e++){let t=this.selectedInput.children[e];this.successAnimation(t)}if(void 0===Object.values(this.result)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1]){let e=Object.values(this.result)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]=!0,Object.defineProperty(this.result,Object.keys(this.result)[this.inputIndex%3-1],{value:e});let t=this.selectedInput;setTimeout(e=>{t.classList.remove("shadowDesign"),t.classList.add("greenShadowDesign")},500)}}else{for(let e=0;e<this.selectedInput.childElementCount;e++){let t=this.selectedInput.children[e];this.failureAnimation(t)}if(void 0===Object.values(this.result)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1]){let e=Object.values(this.result)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]=!1,Object.defineProperty(this.result,Object.keys(this.result)[this.inputIndex%3-1],{value:e})}let e=this.selectedInput;setTimeout(t=>{e.classList.remove("shadowDesign"),e.classList.add("redShadowDesign")},500)}}if(this.inputIndex<18-this.v)this.inputIndex+=3,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount,"Enter"===t.key&&this.selectedInput.classList.contains("known-case")&&(this.inputIndex<18-this.v?(this.inputIndex+=3,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount):this.inputIndex===19-this.v&&(this.inputIndex=5,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount));else if("Enter"===t.key&&this.inputIndex===19-this.v)this.inputIndex=5,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount;else if("Enter"===t.key&&this.inputIndex===20-this.v&&(this.currentWord.singular.forEach((e,t)=>{let n=1+(t+1)*3;if(this.compare(e,Object.values(this.vocabulary[this.currentWordIndex])[n%3-1][Math.floor(n/3)-1])){for(let e=0;e<this.container.children[n].childElementCount;e++)if(n%3!=0&&!this.container.children[n].classList.contains("known-case")){let t=this.container.children[n].children[e];this.successAnimation(t)}if(void 0===Object.values(this.result)[n%3-1][Math.floor(n/3)-1]){let e=Object.values(this.result)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]=!0,Object.defineProperty(this.result,Object.keys(this.result)[n%3-1],{value:e})}}else{for(let e=0;e<this.container.children[n].childElementCount;e++)if(n%3!=0&&!this.container.children[n].classList.contains("known-case")){let t=this.container.children[n].children[e];this.failureAnimation(t)}if(void 0===Object.values(this.result)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1]){let e=Object.values(this.result)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]=!1,Object.defineProperty(this.result,Object.keys(this.result)[this.inputIndex%3-1],{value:e})}}}),this.currentWord.plural.forEach((e,t)=>{let n=2+(t+1)*3;if(this.compare(e,Object.values(this.vocabulary[this.currentWordIndex])[n%3-1][Math.floor(n/3)-1])){for(let e=0;e<this.container.children[n].childElementCount;e++)if(n%3!=0&&!this.container.children[n].classList.contains("known-case")){let t=this.container.children[n].children[e];this.successAnimation(t)}if(void 0===Object.values(this.result)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1]){let e=Object.values(this.result)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]=!0,Object.defineProperty(this.result,Object.keys(this.result)[this.inputIndex%3-1],{value:e})}}else{for(let e=0;e<this.container.children[n].childElementCount;e++)if(n%3!=0&&!this.container.children[n].classList.contains("known-case")){let t=this.container.children[n].children[e];this.failureAnimation(t)}if(void 0===Object.values(this.result)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1]){let e=Object.values(this.result)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]=!1,Object.defineProperty(this.result,Object.keys(this.result)[this.inputIndex%3-1],{value:e})}}}),this.compareObjects(this.currentWord,this.vocabulary[this.currentWordIndex]))){this.totalAttempts+=11-this.v/3*2;let t=this.result.singular.filter(e=>!0===e).length+this.result.plural.filter(e=>!0===e).length;this.totalPoints+=t,t!=12-this.v/3*2?this.vocabulary[this.currentWordIndex].probability*=.8:this.vocabulary[this.currentWordIndex].probability*=1.2;let n=this.database.transaction("inflected vocabulary","readwrite").objectStore("inflected vocabulary").put(this.vocabulary[this.currentWordIndex],this.currentWordIndex+1);n.onerror=e=>console.error(n.error),setTimeout(t=>{document.querySelectorAll(".selectedElement").forEach(e=>{e.classList.remove("selectedElement")}),this.keys=0,this.inputIndex=4,this.selectedInput=document.querySelector("#div4"),this.selectedInput.classList.add("selectedElement"),this.startNewTrainingRound(e||"nouns")},500)}return}if("ArrowUp"===t.key){this.inputIndex>6&&(this.inputIndex-=3,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount);return}if("Backspace"===t.key){if(this.selectedInput.lastElementChild){this.selectedInput.lastElementChild.remove();let e=Object.values(this.currentWord)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]=e[Math.floor(this.inputIndex/3)-1].slice(0,this.keys-1),Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:e}),this.keys--}return}if(this.selectedInput.classList.contains("known-case"))return;if("Tab"==t.key){if(this.tabulator){if(this.keys+this.tabulator.length>=this.selectedInput.clientWidth/(this.selectedInput.clientHeight-parseFloat(this.selectedInput.style.padding)))this.selectedInput.childNodes.forEach((e,t)=>{this.failureAnimation(this.selectedInput.children[t])});else{let e=Object.values(this.currentWord)[this.inputIndex%3-1],t=Math.floor(this.inputIndex/3)-1;e[t]+=this.tabulator,Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:e}),this.tabulator.split("").forEach(e=>{let t=document.createElement("object");t.data="./keys/OG_T.svg",t.id=`key${this.keys}-inp${this.inputIndex}`,t.style.height="100%",this.selectedInput.insertAdjacentElement("beforeend",t),t.hidden=!0,t.addEventListener("load",n=>{t.hidden=!1,t.contentDocument.querySelector("#tspan7").innerHTML=e,this.keys++,this.tabulatorAnimation(t)})})}}return}else if(["<","´","`","^"].includes(t.key)||t.key.length>1)return;let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${this.keys}-inp${this.inputIndex}`,n.style.height="100%",this.selectedInput.insertAdjacentElement("beforeend",n);let i=n.clientHeight;n.hidden=!0,n.addEventListener("load",e=>{if(this.keys+1>=Math.floor(this.selectedInput.clientWidth/i)){n.remove();for(let e=0;e<this.keys;e++)this.failureAnimation(this.selectedInput.children[e]);return}n.hidden=!1,n.contentDocument.querySelector("#tspan7").innerHTML=t.key.charAt(0);let s=Object.values(this.currentWord)[this.inputIndex%3-1];s[Math.floor(this.inputIndex/3)-1]+=t.key,Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:s}),this.keys++,this.idleAnimation(n)})},document.addEventListener("keydown",this.keydownFunction),window.onkeyup=e=>{"Tab"===e.key&&this.container.focus()},this.startNewTrainingRound(e||"nouns");break;case"add verbs":case"add nouns":let t;this.keys=0,document.querySelectorAll(".editable").forEach(e=>{e.addEventListener("click",t=>{this.tabMode&&this.cancelTabMode(),this.inputIndex=parseInt(e.id.slice(3)),this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount})}),this.selectedInput=document.getElementById("div4"),this.selectedInput.classList.add("selectedElement"),this.inputIndex=4,this.wordIndex=this.vocabulary.length,this.currentWord={singular:this.empty(e),plural:this.empty(e),verb:e.includes("verb"),probability:1};let n=!1,i=t=>{this.vocabulary.splice(this.wordIndex,1);let s=this.database.transaction("inflected vocabulary","readwrite").objectStore("inflected vocabulary").openCursor();s.onsuccess=t=>{let n=s.result;if(n){let t=n.key,i=this.vocabulary[t-1];if(i){let e=n.value;e.singular=i.singular,e.plural=i.plural,e.verb=i.verb,e.probability=i.probability,n.update(e),n.continue()}else{n.delete();let t=this.vocabulary.slice(0,this.wordIndex),i=this.vocabulary.slice(this.wordIndex),s=t.findLastIndex(t=>t.verb===e.includes("verb")),r=i.findIndex(t=>t.verb===e.includes("verb"))+this.wordIndex;if(this.vocabulary[s]){this.wordIndex=s,this.currentWord=this.vocabulary[s];let e=[],t=!1;for(let n=3;n<this.container.childElementCount;n++){let i=[],s=Math.floor(n/3)-1,r=this.currentWord.singular,o=this.currentWord.plural;if(n%3==1){this.container.children[n].innerHTML="";for(let o=0;o<r[Math.floor(n/3)-1].length;o++)if("^tab^"===r[s].slice(o,o+5))t=!t,o+=4;else{let s=document.createElement("object");s.data="./keys/OG_T.svg",s.id=`key${o}-inp${n}`,s.style.height="100%",this.container.children[n].insertAdjacentElement("beforeend",s),t&&i.push(o),s.addEventListener("load",t=>{s.contentDocument.querySelector("#tspan7").innerHTML=r[Math.floor(n/3)-1].charAt(o),void 0!=e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))&&e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))[1].includes(parseInt(s.id.slice(3)))&&(this.tabulatorAnimation(s),s.classList.add("tabulator"))})}e.push([n,i])}else if(n%3==2){this.container.children[n].innerHTML="";for(let r=0;r<o[Math.floor(n/3)-1].length;r++)if("^tab^"===o[s].slice(r,r+5))t=!t,r+=4;else{let s=document.createElement("object");s.data="./keys/OG_T.svg",s.id=`key${r}-inp${n}`,s.style.height="100%",this.container.children[n].insertAdjacentElement("beforeend",s),t&&i.push(r),s.addEventListener("load",t=>{s.contentDocument.querySelector("#tspan7").innerHTML=o[Math.floor(n/3)-1].charAt(r),void 0!=e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))&&e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))[1].includes(parseInt(s.id.slice(3)))&&(this.tabulatorAnimation(s),s.classList.add("tabulator"))})}}e.push([n,i])}this.changeSelectedInput()}else if(this.vocabulary[r]){this.currentWord=this.vocabulary[r];let e=[],t=!1;for(let n=3;n<this.container.childElementCount;n++){let i=[],s=Math.floor(n/3)-1,r=this.currentWord.singular,o=this.currentWord.plural;if(n%3==1){this.container.children[n].innerHTML="";for(let o=0;o<r[Math.floor(n/3)-1].length;o++)if("^tab^"===r[s].slice(o,o+5))t=!t,o+=4;else{let s=document.createElement("object");s.data="./keys/OG_T.svg",s.id=`key${o}-inp${n}`,s.style.height="100%",this.container.children[n].insertAdjacentElement("beforeend",s),t&&i.push(o),s.addEventListener("load",t=>{s.contentDocument.querySelector("#tspan7").innerHTML=r[Math.floor(n/3)-1].charAt(o),e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))&&e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))[1].includes(parseInt(s.id.slice(3)))&&(this.tabulatorAnimation(s),s.classList.add("tabulator"))})}e.push([n,i])}else if(n%3==2){this.container.children[n].innerHTML="";for(let r=0;r<o[Math.floor(n/3)-1].length;r++)if("^tab^"===o[s].slice(r,r+5))t=!t,r+=4;else{let s=document.createElement("object");s.data="./keys/OG_T.svg",s.id=`key${r}-inp${n}`,s.style.height="100%",this.container.children[n].insertAdjacentElement("beforeend",s),t&&i.push(r),s.addEventListener("load",t=>{s.contentDocument.querySelector("#tspan7").innerHTML=o[Math.floor(n/3)-1].charAt(r),e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))&&e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))[1].includes(parseInt(s.id.slice(3)))&&(this.tabulatorAnimation(s),s.classList.add("tabulator"))})}e.push([n,i])}}this.changeSelectedInput()}else{this.keys=0,this.currentWord={singular:this.empty(e),plural:this.empty(e),verb:e.includes("verb"),probability:1};for(let e=0;e<this.container.childElementCount;e++)e%3!=0&&(this.container.children[e].innerHTML=""),this.container.children[e].classList.remove("selectedElement");this.inputIndex=4,this.selectedInput=this.container.children[4],this.tabCount=0,this.selectedInput.classList.add("selectedElement")}}}},n=!1,this.deletionButton.removeEventListener("click",i),this.deletionButton.classList.remove("click"),document.querySelectorAll("object").forEach(e=>{e.contentDocument.getElementById("tspan7")&&this.deletionAnimation(e,1,"reverse")}),Array.from(document.getElementsByClassName("editable")).forEach(e=>{e.classList.remove("redShadowDesign")})};this.deletionButton.addEventListener("mousemove",e=>{if(n)return;n=!0,this.deletionAnimation(this.deletionButton,2e3,"normal");let s=!1;this.container.querySelectorAll("object").forEach(e=>{if(e.contentDocument.getElementById("tspan7"))this.deletionAnimation(e,2e3,"normal");else{s=!0;return}}),s&&this.container.querySelectorAll("object").forEach(e=>{e.contentDocument.getElementById("tspan7")&&this.deletionAnimation(e,1,"reverse")}),t=setTimeout(e=>{n&&(this.deletionButton.addEventListener("click",i),Array.from(document.getElementsByClassName("editable")).forEach(e=>{e.classList.add("redShadowDesign")}))},2e3)}),this.deletionButton.addEventListener("mouseleave",e=>{clearTimeout(t),n=!1,this.deletionAnimation(this.deletionButton,1,"reverse"),this.container.querySelectorAll("object").forEach(e=>{e.contentDocument.getElementById("tspan7")&&this.deletionAnimation(e,1,"reverse")}),Array.from(document.getElementsByClassName("editable")).forEach(e=>{e.classList.remove("redShadowDesign")}),this.deletionButton.removeEventListener("click",i)}),document.querySelectorAll(".c").forEach(e=>{e.addEventListener("mousedown",t=>{e.classList.add("click"),document.querySelectorAll(".editable").forEach(e=>{e.classList.add("savedElement")})}),e.addEventListener("mouseout",t=>{e.classList.remove("click"),document.querySelectorAll(".editable").forEach(e=>{e.classList.remove("savedElement")})})}),this.buttonLeft.addEventListener("mouseup",t=>{console.log("left",this.vocabulary.map(e=>e.singular[0])),this.tabMode&&this.cancelTabMode();let n=this.vocabulary.slice(0,this.wordIndex).findLastIndex(t=>t.verb===e.includes("verb"));if(this.vocabulary[n]){if(this.currentWord.singular.filter(e=>""===e).length===(e.includes("verb")?3:6)&&this.currentWord.plural.filter(e=>""===e).length===(e.includes("verb")?3:6)&&this.wordIndex===this.vocabulary.length){for(let e=0;e<this.container.childElementCount;e++)this.container.children[e].classList.remove("savedElement"),this.buttonLeft.classList.remove("click");this.wordIndex=n,this.currentWord=this.vocabulary[n];let e=[],t=!1;for(let n=3;n<this.container.childElementCount;n++){let i=[],s=Math.floor(n/3)-1,r=this.currentWord.singular,o=this.currentWord.plural;if(n%3==1){this.container.children[n].innerHTML="";for(let o=0;o<r[Math.floor(n/3)-1].length;o++)if("^tab^"===r[s].slice(o,o+5))t=!t,o+=4;else{let s=document.createElement("object");s.data="./keys/OG_T.svg",s.id=`key${o}-inp${n}`,s.style.height="100%",this.container.children[n].insertAdjacentElement("beforeend",s),t&&i.push(o),s.addEventListener("load",t=>{s.contentDocument.querySelector("#tspan7").innerHTML=r[Math.floor(n/3)-1].charAt(o),void 0!=e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))&&e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))[1].includes(parseInt(s.id.slice(3)))&&(this.tabulatorAnimation(s),s.classList.add("tabulator"))})}e.push([n,i])}else if(n%3==2){this.container.children[n].innerHTML="";for(let r=0;r<o[Math.floor(n/3)-1].length;r++)if("^tab^"===o[s].slice(r,r+5))t=!t,r+=4;else{let s=document.createElement("object");s.data="./keys/OG_T.svg",s.id=`key${r}-inp${n}`,s.style.height="100%",this.container.children[n].insertAdjacentElement("beforeend",s),t&&i.push(r),s.addEventListener("load",t=>{s.contentDocument.querySelector("#tspan7").innerHTML=o[Math.floor(n/3)-1].charAt(r),void 0!=e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))&&e.find(e=>e[0]===parseInt(s.parentElement.id.slice(3)))[1].includes(parseInt(s.id.slice(3)))&&(this.tabulatorAnimation(s),s.classList.add("tabulator"))})}}e.push([n,i])}this.changeSelectedInput()}else{this.vocabulary[this.wordIndex]=this.currentWord;let e=this.database.transaction("inflected vocabulary","readwrite");e.onerror=t=>console.error(e.error);let t=e.objectStore("inflected vocabulary"),i=t.get(this.wordIndex);i.onerror=e=>console.error(i.error),i.onsuccess=e=>{for(let e=0;e<this.container.childElementCount;e++)this.container.children[e].classList.remove("savedElement"),this.buttonLeft.classList.remove("click");let i=t.put(this.currentWord,this.wordIndex+1);i.onerror=e=>console.error(i.error),this.wordIndex=n;let s=!1;this.currentWord=this.vocabulary[n];let r=[];for(let e=3;e<this.container.childElementCount;e++){let t=[],n=Math.floor(e/3)-1,i=this.currentWord.singular,o=this.currentWord.plural;if(e%3==1){this.container.children[e].innerHTML="";for(let o=0;o<i[n].length;o++)if("^tab^"===i[n].slice(o,o+5))s=!s,o+=4;else{let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${o}-inp${e}`,n.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",n),s&&t.push(o),n.addEventListener("load",t=>{n.contentDocument.querySelector("#tspan7").innerHTML=i[Math.floor(e/3)-1].charAt(o),void 0!=r.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))&&r.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))[1].includes(parseInt(n.id.slice(3)))&&(this.tabulatorAnimation(n),n.classList.add("tabulator"))})}r.push([e,t])}else if(e%3==2){this.container.children[e].innerHTML="";for(let i=0;i<o[Math.floor(e/3)-1].length;i++)if("^tab^"===o[n].slice(i,i+5))s=!s,i+=4;else{let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${i}-inp${e}`,n.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",n),s&&t.push(i),n.addEventListener("load",t=>{n.contentDocument.querySelector("#tspan7").innerHTML=o[Math.floor(e/3)-1].charAt(i),void 0!=r.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))&&r.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))[1].includes(parseInt(n.id.slice(3)))&&(this.tabulatorAnimation(n),n.classList.add("tabulator"))})}r.push([e,t])}}}}}console.log("left end",this.vocabulary.map(e=>e.singular[0]))}),this.buttonRight.addEventListener("mouseup",t=>{console.log("right",this.vocabulary.map(e=>e.singular[0])),this.tabMode&&this.cancelTabMode();let n=this.vocabulary.slice(this.wordIndex+1),i=n.findIndex(t=>t.verb===e.includes("verb"))>=0?n.findIndex(t=>t.verb===e.includes("verb"))+this.wordIndex+1:-1;if(this.vocabulary[i]){console.log("this.vocabulary[wi]"),this.vocabulary[this.wordIndex]=this.currentWord;for(let e=0;e<this.container.childElementCount;e++)this.container.children[e].classList.remove("savedElement"),this.buttonRight.classList.remove("click");let e=this.database.transaction("inflected vocabulary","readwrite");e.onerror=t=>console.error(e.error);let t=e.objectStore("inflected vocabulary"),n=t.get(this.wordIndex);n.onerror=e=>console.error(n.error),n.onsuccess=e=>{let n=t.put(this.currentWord,this.wordIndex+1);n.onerror=e=>console.error(n.error),this.wordIndex=i,this.currentWord=this.vocabulary[i];let s=[],r=!1;for(let e=3;e<this.container.childElementCount;e++){let t=[],n=Math.floor(e/3)-1,i=this.currentWord.singular,o=this.currentWord.plural;if(e%3==1){this.container.children[e].innerHTML="";for(let o=0;o<i[Math.floor(e/3)-1].length;o++)if("^tab^"===i[n].slice(o,o+5))r=!r,o+=4;else{let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${o}-inp${e}`,n.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",n),r&&t.push(o),n.addEventListener("load",t=>{n.contentDocument.querySelector("#tspan7").innerHTML=i[Math.floor(e/3)-1].charAt(o),s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))&&s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))[1].includes(parseInt(n.id.slice(3)))&&(this.tabulatorAnimation(n),n.classList.add("tabulator"))})}s.push([e,t])}else if(e%3==2){this.container.children[e].innerHTML="";for(let i=0;i<o[Math.floor(e/3)-1].length;i++)if("^tab^"===o[n].slice(i,i+5))r=!r,i+=4;else{let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${i}-inp${e}`,n.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",n),r&&t.push(i),n.addEventListener("load",t=>{n.contentDocument.querySelector("#tspan7").innerHTML=o[Math.floor(e/3)-1].charAt(i),s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))&&s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))[1].includes(parseInt(n.id.slice(3)))&&(this.tabulatorAnimation(n),n.classList.add("tabulator"))})}s.push([e,t])}this.changeSelectedInput()}}}else{console.log("!this.vocabulary[wi]"),this.vocabulary[this.wordIndex]=this.currentWord;let t=this.database.transaction("inflected vocabulary","readwrite");t.onerror=e=>console.error(t.error);let n=t.objectStore("inflected vocabulary").put(this.currentWord,this.wordIndex+1);n.onerror=e=>console.error(n.error),t.oncomplete=t=>{for(let e=0;e<this.container.childElementCount;e++)this.container.children[e].classList.remove("savedElement"),this.buttonRight.classList.remove("click");this.wordIndex=this.vocabulary.length,this.keys=0,this.currentWord={singular:this.empty(e),plural:this.empty(e),verb:e.includes("verb"),probability:1};for(let e=3;e<this.container.childElementCount;e++)e%3!=0&&(this.container.children[e].innerHTML=""),this.container.children[e].classList.remove("selectedElement");this.inputIndex=4,this.selectedInput=this.container.children[4],this.tabCount=0,this.selectedInput.classList.add("selectedElement")}}console.log("right end",this.vocabulary.map(e=>e.singular[0]))}),this.keydownFunction=t=>{if("ArrowRight"===t.key){this.tabMode&&this.cancelTabMode(),this.inputIndex<20-this.v&&(this.inputIndex++,this.inputIndex%3==0&&this.inputIndex++,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount);return}if("ArrowLeft"===t.key){this.tabMode&&this.cancelTabMode(),this.inputIndex>4&&(this.inputIndex--,this.inputIndex%3==0&&this.inputIndex--,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount);return}if("ArrowDown"===t.key||"Enter"===t.key){if(this.tabMode&&(this.cancelTabMode(),19===this.inputIndex))return;if(this.inputIndex<18-this.v)this.inputIndex+=3,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount;else if("Enter"===t.key&&this.inputIndex===19-this.v)this.inputIndex=5,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount;else if("Enter"===t.key&&this.inputIndex===20-this.v){if(document.querySelectorAll(".editable").forEach(e=>{e.classList.add("savedElement")}),this.enterMode){let t=this.vocabulary.slice(this.wordIndex+1).findIndex(t=>t.verb===e.includes("verb"));if(this.vocabulary[t]){this.vocabulary[this.wordIndex]=this.currentWord;for(let e=0;e<this.container.childElementCount;e++)this.container.children[e].classList.remove("savedElement");let e=this.database.transaction("inflected vocabulary","readwrite");e.onerror=t=>console.error(e.error);let n=e.objectStore("inflected vocabulary"),i=n.get(this.wordIndex);i.onerror=e=>console.error(i.error),i.onsuccess=e=>{let i=n.put(this.currentWord,this.wordIndex+1);i.onerror=e=>console.log(i.error),this.wordIndex=t,this.currentWord=this.vocabulary[t];let s=[],r=!1;for(let e=3;e<this.container.childElementCount;e++){let t=[],n=Math.floor(e/3)-1,i=this.currentWord.singular,o=this.currentWord.plural;if(e%3==1){this.container.children[e].innerHTML="";for(let o=0;o<i[Math.floor(e/3)-1].length;o++)if("^tab^"===i[n].slice(o,o+5))r=!r,o+=4;else{let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${o}-inp${e}`,n.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",n),r&&t.push(o),n.addEventListener("load",t=>{n.contentDocument.querySelector("#tspan7").innerHTML=i[Math.floor(e/3)-1].charAt(o),s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))&&s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))[1].includes(parseInt(n.id.slice(3)))&&(this.tabulatorAnimation(n),n.classList.add("tabulator"))})}s.push([e,t])}else if(e%3==2){this.container.children[e].innerHTML="";for(let i=0;i<o[Math.floor(e/3)-1].length;i++)if("^tab^"===o[n].slice(i,i+5))r=!r,i+=4;else{let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${i}-inp${e}`,n.style.height="100%",this.container.children[e].insertAdjacentElement("beforeend",n),r&&t.push(i),n.addEventListener("load",t=>{n.contentDocument.querySelector("#tspan7").innerHTML=o[Math.floor(e/3)-1].charAt(i),s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))&&s.find(e=>e[0]===parseInt(n.parentElement.id.slice(3)))[1].includes(parseInt(n.id.slice(3)))&&(this.tabulatorAnimation(n),n.classList.add("tabulator"))})}s.push([e,t])}this.changeSelectedInput()}}}else{this.vocabulary[this.wordIndex]=this.currentWord;let t=this.database.transaction("inflected vocabulary","readwrite");t.onerror=e=>console.error(t.error);let n=t.objectStore("inflected vocabulary").put(this.currentWord,this.wordIndex+1);n.onerror=e=>console.error(n.error),t.oncomplete=t=>{for(let e=0;e<this.container.childElementCount;e++)this.container.children[e].classList.remove("savedElement");this.wordIndex++,this.keys=0,this.currentWord={singular:this.empty(e),plural:this.empty(e),verb:e.includes("verb"),probability:1};for(let e=0;e<this.container.childElementCount;e++)e%3!=0&&(this.container.children[e].innerHTML=""),this.container.children[e].classList.remove("selectedElement");this.inputIndex=4,this.selectedInput=this.container.children[4],this.tabCount=0,this.selectedInput.classList.add("selectedElement")}}this.enterMode=!1}else this.enterMode=!0;let t=this.database.transaction("inflected vocabulary","readwrite").objectStore("inflected vocabulary").put(this.currentWord,this.wordIndex+1);t.onerror=e=>console.error(t.error),setTimeout(e=>{for(let e=0;e<this.container.childElementCount;e++)this.container.children[e].classList.remove("savedElement")},250)}return}if("ArrowUp"===t.key){this.tabMode&&this.cancelTabMode(),this.inputIndex>6&&(this.inputIndex-=3,this.changeSelectedInput(),this.keys=this.selectedInput.childElementCount);return}if("Backspace"===t.key){if(this.selectedInput.lastElementChild){this.selectedInput.lastElementChild.remove();let e=Object.values(this.currentWord)[this.inputIndex%3-1],t=Math.floor(this.inputIndex/3)-1;"^tab^"===e[t].slice(-5)?(e[t]=e[t].slice(0,e[t].length-6),this.tabCount>1&&this.tabCount--,this.tabMode=!this.tabMode,this.selectedInput.classList.add("tab"),this.tabMode||this.selectedInput.classList.remove("tab")):e[t]=e[t].slice(0,e[t].length-1),Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:e}),this.keys--,this.tabMode&&(this.tabulator=this.tabulator.slice(0,this.tabulator.length-1))}else this.tabMode&&this.cancelTabMode();return}if("Tab"===t.key){if(this.tabMode){if(this.tabulator.length>0){if("^tab^"!=Object.values(this.currentWord)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1].slice(-5)){this.tabMode=!1,this.selectedInput.classList.remove("tab");let e=Object.values(this.currentWord)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]+="^tab^",Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:e}),this.tabCount++}else{let e=Object.values(this.currentWord)[this.inputIndex%3-1],t=Math.floor(this.inputIndex/3)-1;e[t]+=this.tabulator+"^tab^";let n=e[t].search(this.tabulator);if(-1===n&&(n=0),this.keys+this.tabulator.length<=Math.floor(this.selectedInput.clientWidth/(this.selectedInput.clientHeight-parseFloat(this.selectedInput.style.padding))))for(let e=0;e<this.tabulator.length;e++){let t=document.createElement("object");t.data="./keys/OG_T.svg",t.id=`key${this.keys}-inp${this.inputIndex}`,t.style.height="100%",this.selectedInput.insertAdjacentElement("beforeend",t),t.hidden=!0,t.addEventListener("load",n=>{t.hidden=!1,this.tabulatorAnimation(t),t.classList.add("tabulator"),t.contentDocument.querySelector("#tspan7").innerHTML=this.tabulator.charAt(e),this.tabulator.length}),this.keys++}else{for(let e=0;e<this.keys;e++)this.failureAnimation(this.selectedInput.children[e]);return}Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:e}),this.tabMode=!1,this.tabCount++,this.selectedInput.classList.remove("tab")}}else this.tabCount=0,this.cancelTabMode()}else if(this.tabCount>=2){let e,t=Object.values(this.currentWord)[this.inputIndex%3-1],n=Math.floor(this.inputIndex/3)-1;for(;-1!==t[n].search("\\^tab\\^");){let i=t[n].search("\\^tab\\^");void 0===e&&(e=i),t[n]=t[n].slice(0,i)+t[n].slice(i+5,t[n].length)}t[n]=t[n].slice(0,e)+"^tab^"+t[n].slice(e,t[n].length),Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:t});let i=!1;for(let s=0;s<t[n].length;s++)if("^tab^"===t[n].slice(s,s+5))i=!i,s+=4;else if(this.selectedInput.children[s>e?s-5:s]){let r=this.selectedInput.children[s>e?s-5:s];r.contentDocument.querySelector("#tspan7").innerHTML=t[n].charAt(s),i?(this.tabulatorAnimation(r),r.classList.add("tabulator")):r.classList.remove("tabulator"),this.selectedInput.children[s]}this.tabulator=t[n].slice(e+5,t[n].length),this.tabCount=1,this.tabMode=!0,this.selectedInput.classList.add("tab")}else{this.tabMode=!0,this.selectedInput.classList.add("tab");let e=Object.values(this.currentWord)[this.inputIndex%3-1];e[Math.floor(this.inputIndex/3)-1]+="^tab^",Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:e}),this.tabCount++}return}if(["<","´","`","^"].includes(t.key)||t.key.length>1)return;this.enterMode=!1;let n=document.createElement("object");n.data="./keys/OG_T.svg",n.id=`key${this.keys}-inp${this.inputIndex}`,n.style.height="100%",this.selectedInput.insertAdjacentElement("beforeend",n);let i=n.clientHeight;n.hidden=!0,n.addEventListener("load",e=>{if(this.keys+1>=Math.floor(this.selectedInput.clientWidth/i)){n.remove();for(let e=0;e<this.keys;e++)this.failureAnimation(this.selectedInput.children[e]);return}n.hidden=!1,n.contentDocument.querySelector("#tspan7").innerHTML=t.key.charAt(0);let s=Math.floor(this.inputIndex/3)-1,r=Object.values(this.currentWord)[this.inputIndex%3-1];r[s]+=t.key,Object.defineProperty(this.currentWord,Object.keys(this.currentWord)[this.inputIndex%3-1],{value:r}),this.tabMode?("^tab^"===r[s].slice(-6,-1)&&(this.tabulator=""),this.tabulator+=t.key,this.tabulatorAnimation(n),n.classList.add("tabulator")):this.idleAnimation(n),this.keys++})},document.addEventListener("keydown",this.keydownFunction),window.onkeyup=e=>{"Tab"===e.key&&this.container.focus()}}}empty(e){let t=e.includes("verb")?3:6,n=[];for(let e=0;e<t;e++)n.push("");return n}changeSelectedInput(){document.querySelectorAll(".selectedElement").forEach(e=>e.classList.remove("selectedElement")),this.selectedInput=document.getElementById(`div${this.inputIndex}`);let e=Object.values(this.currentWord)[this.inputIndex%3-1][Math.floor(this.inputIndex/3)-1],t=RegExp("\\^tab\\^","g"),n=e.match(t);this.tabCount=n?n.length:0,n&&n.length%2==0&&this.selectedInput.classList.remove("tab"),this.selectedInput.classList.add("selectedElement")}cancelTabMode(){let e=Object.values(this.currentWord)[this.inputIndex%3-1],t=Math.floor(this.inputIndex/3)-1;if(e[t].includes("^tab^")){let n=[];for(;e[t].search("\\^tab\\^")>=0;){let i=e[t].search("\\^tab\\^");e[t]=e[t].slice(0,i)+e[t].slice(i+5,e[t].length),n.push(i)}1===n.length&&n.push(e[t].length);let i=e[t].slice(n[0],n[1]);for(let e=0;e<i.length;e++)this.selectedInput.children[n[0]].remove();e[t]=e[t].slice(0,n[0])+e[t].slice(n[1],e[t].length),this.keys-=i.length}this.tabMode=!1,this.selectedInput.classList.remove("tab")}findMostUsedTabulator(e){if(e.singular){let t=e.singular.map(e=>{if(e.includes("^tab^")){let t,n=e,i=n.length;for(;n.includes("^tab^");){let e=n.search("\\^tab\\^");n=n.slice(0,e)+n.slice(e+5,i),void 0===t?t=e:i=e}return n.slice(t||0,i)}}).concat(e.plural.map(e=>{if(e.includes("^tab^")){let t,n=e,i=n.length;for(;n.includes("^tab^");){let e=n.search("\\^tab\\^");n=n.slice(0,e)+n.slice(e+5,i),void 0===t?t=e:i=e}return n.slice(t||0,i)}})).filter(e=>void 0!=e),n=[];t.forEach(e=>{if(n.map(e=>e[0]).includes(e)){let t=n.findIndex(t=>t[0]===e);n[t]=[e,n[t][1]+1]}else n.push([e,1])});for(let e=0;e<n.length;e++)n.sort((e,t)=>t[1]-e[1]);return n.length>0?n[0][0]:void 0}}startNewTrainingRound(e){let t,n,i,s=this.vocabulary.filter(t=>t.verb===e.includes("verb"));if(0===s.length){setTimeout(t=>alert(`Keine ${e.includes("verb")?"Konjugationen":"Deklinationen"}!`),250);return}if(0===s.filter(e=>!r(e)).length){setTimeout(t=>alert(`Nur leere ${e.includes("verb")?"Konjugationen":"Deklinationen"}!`),250);return}function r(t){return t.singular.filter(e=>""===e.trim()).length===(e.includes("verb")?6:3)&&t.plural.filter(e=>""===e.trim()).length===(e.includes("verb")?6:3)}this.round++;let o=0;s.forEach(e=>{r(e)||(o+=e.probability)});let l=Math.floor(Math.random()*o*10)/10,a=0;this.failures=0,this.vocabulary.forEach((n,i)=>{r(n)||n.verb!==e.includes("verb")||(void 0===t?(t=Math.abs(l-(a+n.probability)),this.currentWord=n,this.currentWordIndex=i):Math.abs(l-(a+n.probability))<t&&(t=Math.abs(l-(a+n.probability)),this.currentWordIndex=i,this.currentWord=n),a+=n.probability)}),this.tabulator=this.findMostUsedTabulator(this.currentWord),document.querySelectorAll(".editable").forEach(e=>{e.innerHTML="",e.classList.remove("redShadowDesign"),e.classList.remove("greenShadowDesign"),e.classList.remove("known-case"),e.classList.add("shadowDesign")});let c=this.v/3;do i=Math.floor(Math.random()*(e.includes("verb")?6:12)),n=Object.values(this.vocabulary[this.currentWordIndex])[i>5-c?1:0][i>5-c?i-6+c:i];while(""===n)for(;n.includes("^tab^");){let e=n.search("\\^tab\\^");n=n.slice(0,e)+n.slice(e+5,n.length)}let d=document.getElementById(`div${i>5-c?2+(i-5+c)*3:1+(i+1)*3}`);d.classList.add("known-case"),d.innerHTML=`<span>${n}</span>`;let h=this.empty(e);h[i>5-c?i-6+c:i]=n,this.currentWord={singular:i<=5-c?h:this.empty(e),plural:i>5-c?h:this.empty(e),verb:e.includes("verb"),probability:this.currentWord.probability},this.result={singular:e.includes("verb")?[void 0,void 0,void 0]:[void 0,void 0,void 0,void 0,void 0,void 0],plural:e.includes("verb")?[void 0,void 0,void 0]:[void 0,void 0,void 0,void 0,void 0,void 0]}}compare(e,t){for(;e.includes("^tab^");){let t=e.search("\\^tab\\^");e=e.slice(0,t)+e.slice(t+5,e.length)}for(;t.includes("^tab^");){let e=t.search("\\^tab\\^");t=t.slice(0,e)+t.slice(e+5,t.length)}return e===t}compareObjects(e,t){let n=JSON.parse(JSON.stringify(e)),i=JSON.parse(JSON.stringify(t));return n.singular.forEach((e,t)=>{for(;e.includes("^tab^");){let t=e.search("\\^tab\\^");e=e.slice(0,t)+e.slice(t+5,e.length)}n.singular[t]=e}),n.plural.forEach((e,t)=>{for(;e.includes("^tab^");){let t=e.search("\\^tab\\^");e=e.slice(0,t)+e.slice(t+5,e.length)}n.plural[t]=e}),i.singular.forEach((e,t)=>{for(;e.includes("^tab^");){let t=e.search("\\^tab\\^");e=e.slice(0,t)+e.slice(t+5,e.length)}i.singular[t]=e}),i.plural.forEach((e,t)=>{for(;e.includes("^tab^");){let t=e.search("\\^tab\\^");e=e.slice(0,t)+e.slice(t+5,e.length)}i.plural[t]=e}),Object.values(n).slice(0,3).toLocaleString()===Object.values(i).slice(0,3).toLocaleString()}failureAnimation(e){if(!e)return;let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s=[{stroke:this.badColor,offset:.025},{rotate:"10deg z",offset:.25},{rotate:"0deg z",offset:.5},{rotate:"-10deg z",offset:.75,stroke:this.badColor},{stroke:"#eeeeeeff",offset:.925},{rotate:"0deg z",offset:1}],r={duration:500};n.animate(s,r),i.animate(s,r)}idleAnimation(e){let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#8f8f8f","#fff","#eeeeeeff"],offset:[0,1]},r={duration:250};n.animate(s,r),i.animate(s,r)}tabulatorAnimation(e){if(!e)return;let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#eeeeeeff","rgb(186, 2, 70)"===this.badColor?"#4400ff":"rgb(211, 0, 0)"],offset:[0,1]},r={duration:250,fill:"forwards"};n.animate(s,r),i.animate(s,r)}successAnimation(e){if(!e)return;let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#eeeeeeff","#08a000","#eeeeeeff"],offset:[0,1]},r={duration:500};n.animate(s,r),i.animate(s,r)}deletionAnimation(e,t,n){if("OBJECT"===e.tagName){let i=e.contentDocument,s=i.querySelector("#mainRect"),r=i.querySelector("#text7"),o={stroke:[e.classList.contains("tabulator")?"rgb(186, 2, 70)"===this.badColor?"#4400ff":"rgb(211, 0, 0)":"#eeeeeeff",this.badColor],offset:[0,1]},l={duration:t,fill:"forwards",direction:n};s.animate(o,l),r.animate(o,l)}else if("BUTTON"===e.tagName){let i={backgroundColor:["rgb(186, 2, 70)"===this.badColor?"#ff0000":this.badColor,"rgb(186, 2, 70)"===this.badColor?"#ba0303":"#ad0668"],boxShadow:[`0 0 0 0 ${"rgb(186, 2, 70)"===this.badColor?"#ba0303":"#ad0668"}`,`0 0 1vh 1vh ${"rgb(186, 2, 70)"===this.badColor?"#ff0000":this.badColor}`],color:["#ffffff","#eeffff"],border:["none","none"],offset:[0,1]};e.animate(i,{duration:t,fill:"forwards",direction:n})}}},r=new class{constructor(){this.command="",this.modifyDocument()}modifyDocument(){this.resizeFunction=()=>this.movementAnimation(),window.addEventListener("resize",this.resizeFunction),this.input=document.querySelector("#container"),this.iconPlaceholder=document.querySelector("#icon-placeholder"),this.navbar=document.querySelector("#navbar"),document.querySelector(".homeDiv")&&document.querySelector(".homeDiv").remove(),document.body.style.backgroundImage="none",document.body.style.backgroundImage="linear-gradient(180deg, #140063 0%, #06011b 65%, #06011b 77%, #140063 100%)",document.body.setAttribute("class",""),this.input.setAttribute("class",""),this.iconPlaceholder.setAttribute("class",""),this.navbar.setAttribute("class",""),this.input.innerHTML="",this.iconPlaceholder.innerHTML="",this.navbar.innerHTML="";let e=document.createElement("object");e.data="./Icon.svg",e.id="icon",this.iconPlaceholder.insertAdjacentElement("beforeend",e),console.log("servas");let t=document.createElement("object");t.data="./version.svg",t.id="version",this.iconPlaceholder.insertAdjacentElement("beforeend",t),document.body.classList.add("homeBody"),this.input.classList.add("homeInput"),this.iconPlaceholder.classList.add("homeIconPlaceholder"),this.navbar.classList.add("homeNavbar"),this.type()}type(){let e=0;this.keyDownFunction=r=>{if("Backspace"===r.key&&this.input.lastElementChild){this.input.lastElementChild.remove(),this.movementAnimation(),this.command=this.command.slice(0,this.command.length-1),e--;return}if("Enter"===r.key){switch(this.command){case"add vocabulary":case"add":case"add vocabulary":case"neu":case"hinzufügen":case"neues wort":case"neues Wort":case"Vokabeln hinzufügen":o(),t.modifyDocument();break;case"show vocabulary":case"show":case"tabelle":case"Tabelle":case"Vokabeln anzeigen":o(),n.modifyDocument();break;case"training":case"Training":case"trainer":case"Training":case"üben":case"Üben":case"vocabuary training":o(),i.modifyDocument();break;case"declinations":case"deklinationen":case"Deklinationen":case"conj":case"add declinations":o(),s.modifyDocument("add nouns");break;case"deklinieren":case"deklinationstraining":case"Deklinationstraining":case"decline nouns":case"decline":case"ct":o(),s.modifyDocument("nouns");break;case"v":case"conjugations":case"konjugationen":case"Konjugationen":o(),s.modifyDocument("add verbs");break;case"conjugate":case"konjugieren":case"konjugationstraining":case"Konjugationstraining":case"vt":o(),s.modifyDocument("verbs")}this.command="",e=0,this.input.innerHTML="";return}if(["<","´","`","^"].includes(r.key)||r.key.length>1)return;let l=document.createElement("object");l.data="./Latein-Trainer/keys/OG_T.svg",l.id=`key${e}`,l.style.height="100%",this.input.insertAdjacentElement("beforeend",l);let a=l.clientHeight;l.hidden=!0,l.addEventListener("load",t=>{if(e>=Math.floor(window.innerWidth/a)){l.remove();for(let t=0;t<e;t++)this.failureAnimation(this.input.children[t]);return}l.hidden=!1,l.contentDocument.querySelector("#tspan7").innerHTML=r.key.charAt(0),this.command+=r.key,e++,this.idleAnimation(l),this.movementAnimation()})},document.addEventListener("keydown",this.keyDownFunction)}idleAnimation(e){let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s={stroke:["#8f8f8f","#fff","#eeeeeeff"],offset:[0,1]},r={duration:250};n.animate(s,r),i.animate(s,r)}failureAnimation(e){if(!e)return;let t=e.contentDocument,n=t.querySelector("#mainRect"),i=t.querySelector("#text7"),s=[{stroke:"rgb(186, 2, 70)",offset:.025},{rotate:"10deg z",offset:.25},{rotate:"0deg z",offset:.5},{rotate:"-10deg z",offset:.75,stroke:"rgb(186, 2, 70)"},{stroke:"#eeeeeeff",offset:.925},{rotate:"0deg z",offset:1}],r={duration:500};n.animate(s,r),i.animate(s,r)}movementAnimation(){if(!this.input)return;let e=this.input.firstChild,t=this.input;e&&(t.childElementCount>1&&(t.style.transition="padding 250ms"),t.style.paddingLeft=`${(window.innerWidth-t.childElementCount*e.clientHeight)/2}px`)}};function o(){document.removeEventListener("keydown",t.keyDownFunction),document.removeEventListener("keydown",i.keyDownFunction),document.removeEventListener("keydown",r.keyDownFunction),document.removeEventListener("keydown",s.keydownFunction),document.removeEventListener("mouseover",i.mouseOverFunction),window.removeEventListener("resize",r.resizeFunction),window.removeEventListener("resize",i.resizeFunction)}
//# sourceMappingURL=index.4e170ed3.js.map
